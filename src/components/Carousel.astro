<script type="module">
  const carousels = document.querySelectorAll(".carousel-track");

  carousels.forEach((carousel) => {
    if (carousel instanceof HTMLElement && carousel.children.length > 4) {
      const gap = 8;
      const intervalTime = 3000;
      let intervalId;

      const startCarousel = () => {
        intervalId = setInterval(() => {
          const firstChild = carousel.children[0];

          if (firstChild instanceof HTMLElement) {
            const moveWidth = firstChild.offsetWidth + gap;
            carousel.style.transition = "transform 0.8s ease-in-out";
            carousel.style.transform = `translateX(-${moveWidth}px)`;

            setTimeout(() => {
              carousel.appendChild(firstChild);
              carousel.style.transition = "none";
              carousel.style.transform = "translateX(0)";
              void carousel.offsetWidth;
            }, 800);
          }
        }, intervalTime);
      };

      const stopCarousel = () => {
        clearInterval(intervalId);
      };

      carousel.addEventListener("mouseenter", startCarousel);
      carousel.addEventListener("mouseleave", stopCarousel);
    }
  });
</script>

<style>
  .fade-in {
    animation: fadeIn 0.5s ease-in-out;
  }

  @keyframes fadeIn {
    0% {
      opacity: 0;
      transform: translateX(10px);
    }
    100% {
      opacity: 1;
      transform: translateX(0);
    }
  }
</style>

<div class="carousel-container overflow-hidden relative w-full max-w-[400px] mx-auto mt-4">
  <div class="carousel-track flex flex-row gap-2 min-w-full justify-center">
    <slot />
  </div>
</div>
